import statistics_complete.data_gatering as data
import statistics_complete.visualization as visual
import statistics_complete.statistical_package as stat
import utils.constants as c

retranscribe_dirs = [ c.retranscibed_dir / 'custom ctc' / d for d in [ 'whisper_large', 'wav2vec2', 'wav2vec2_LM', 'wav2vec2_custom_LM', 'wav2vec2_custom_LM_hesitations'] ] 
labels = ['whisper', 'wav2vec2', 'libriSpeech LM', 'Switchboard LM', 'SB-hesitation LM']


# # #   after preprocessing    # # #
# stat.dataset_statistic(min_len=[1, 5])

# # #   after transcription    # # #
# stat.manual_automatic_segment_length_by_word_comparison()
# stat.percentage_not_transcribed_speech()
# stat.wer_per_segment(min_lens=[1, 5])
# stat.gaps_containing_speech_manual_time_distribution()

# # #     after alignment      # # #
# stat.gaps_containing_speech_automatic_time_distribution()
# stat.ctc_default_probability_comparison(c.custom_ctc_dirs, c.custom_ctc_labels)
stat.alignment_method_comparison([c.automatic_v3_dir, c.automatic_align_dir / 'ctc', c.automatic_align_dir / 'custom ctc' / '0_01'], ['cross attention', 'ctc', 'ctc (c = -0.01)'])
# stat.best_case_scenario(min_lens=[ i / 10 for i in range(1, 11)])

# # # after gap classification # # #
# stat.classification_model_statistics(threashold=0.9, min_gap=0.3)
# stat.not_transcribed_speech_labelling_statistics(threashold=0.9, min_gap=0.3)

data.before_after_classification_comparison(threashold=0.9, min_gap=0.3)
# # #  after retranscription   # # #
# stat.retranscription_models_comparison(retranscribe_dirs, labels, threshold=0.9)
# stat.final_statistic(retranscribe_dirs, labels, threshold=0.9)
# stat.transcript_comparison(retranscribe_dirs, labels)

# # #         general          # # #
# stat.alignment_visualisation([
#     (c.automatic_align_dir / '0', c.retranscibed_dir / 'wav2vec2', 'automatic ctc'), 
#     (c.automatic_align_dir / '1', None, 'automatic ctc'), 
#     (c.automatic_align_dir / '10', None, 'automatic ctc')
#     ], 10)
# stat.alignment_visualisation(
#     [(c.automatic_align_dir / 'custom ctc' / '0_01', None, '-0.01'), 
#      (c.automatic_align_dir / 'custom ctc' / '0_1', None, '-0.1'), 
#      (c.automatic_align_dir / 'custom ctc' / '0_5', None, '-0.5'), 
#      (c.automatic_align_dir / 'custom ctc' / '1', None, '-1'), 
#      (c.automatic_align_dir / 'ctc', None, 'base'), 
#      ], 20)
# stat.alignment_visualisation(
#     [(c.automatic_align_dir / 'version3', None, 'cross attention'), 
#      (c.automatic_align_dir / 'ctc', None, 'ctc'), 
#      (c.automatic_align_dir / 'custom ctc' / '0_01', None, 'custom\n-0.01'), 
#      (c.automatic_align_dir / 'custom ctc' / '0_01', c.retranscibed_dir / 'custom ctc' / 'wav2vec2_custom_LM', '-0.01 +\nsb 5-gram'), 
#      ], 20)
# visual.plot_alignment_examples( ['manual', 'automatic ctc', 'automatic\ncross attention' ] )
# visual.plot_alignment_examples( ['manual', '0', '1', '2', '3', '4'] )
# visual.plot_alignment_examples( ['manual', '0', '1', '2', '3', '4'] )


# 0.5
#   whisper       │   empty      new   not new          wav2vec2      │   empty     new   not new          libriSpeech LM   │    empty     new   not new          Switchboard LM   │   empty      new   not new          SB-hesitation LM   │   empty      new   not new
#   ──────────────┼───────────────────────────          ──────────────┼──────────────────────────          ─────────────────┼───────────────────────────          ─────────────────┼───────────────────────────          ───────────────────┼───────────────────────────
#   empty         │       0   24,721    11,198          empty         │       0   4,323     9,316          empty            │        0   4,049     9,364          empty            │       0   11,058    10,011          empty              │       0   11,649    10,040
#   transcribed   │     816    4,700   162,741          transcribed   │     864   1,890   165,503          transcribed      │      843   1,916   165,498          transcribed      │     901    2,934   164,422          transcribed        │     900    2,991   164,366
#   not trans.    │   7,058   10,905     2,917          not trans.    │   9,664   9,179     2,037          not trans.       │   10,088   8,798     1,994          not trans.       │   8,294   10,163     2,423          not trans.         │   8,168   10,262     2,450

# wer_data_base = [8599, 20880, 7807, 160450]
# disf_data_base = [23458, 16660]
# wer_data = [[[36118, 7866, 16924, 164347], [24492, 8372, 16568, 164197], [21357, 9087, 16112, 163938], [19341, 10106, 15458, 163573], [17752, 11126, 14814, 163197], [15422, 12069, 14192, 162876], [13220, 13038, 13508, 162591], [12030, 13909, 12924, 162304], [11237, 14720, 12396, 162021], [10664, 15479, 11887, 161771]], [[36337, 8085, 20031, 161021], [24660, 8540, 19573, 161024], [21542, 9272, 18862, 161003], [19543, 10308, 17883, 160946], [17984, 11358, 16905, 160874], [15637, 12284, 16038, 160815], [13389, 13207, 15165, 160765], [12176, 14055, 14361, 160721], [11353, 14836, 13631, 160670], [10762, 15577, 12938, 160622]], [[36344, 8092, 19573, 161472], [24659, 8539, 19124, 161474], [21541, 9271, 18432, 161434], [19543, 10308, 17500, 161329], [17979, 11353, 16589, 161195], [15635, 12282, 15769, 161086], [13388, 13206, 14933, 160998], [12174, 14053, 14162, 160922], [11353, 14836, 13459, 160842], [10761, 15576, 12812, 160749]], [[36312, 8060, 19356, 161721], [24633, 8513, 18938, 161686], [21517, 9247, 18321, 161569], [19531, 10296, 17426, 161415], [17975, 11349, 16497, 161291], [15635, 12282, 15633, 161222], [13387, 13205, 14794, 161138], [12175, 14054, 14036, 161047], [11350, 14833, 13345, 160959], [10757, 15572, 12695, 160870]], [[36308, 8056, 19281, 161800], [24627, 8507, 18874, 161756], [21514, 9244, 18249, 161644], [19529, 10294, 17359, 161484], [17969, 11343, 16436, 161358], [15628, 12275, 15580, 161282], [13382, 13200, 14753, 161184], [12170, 14049, 14000, 161088], [11348, 14831, 13308, 160998], [10755, 15570, 12661, 160906]]]
# disf_data = [[[34505, 5613], [34213, 5905], [33622, 6496], [32736, 7382], [31845, 8273], [31018, 9100], [30160, 9958], [29388, 10730], [28658, 11460], [27983, 12135]], [[31956, 8162], [32147, 7971], [32010, 8108], [31490, 8628], [30826, 9292], [30201, 9917], [29550, 10568], [28919, 11199], [28283, 11835], [27690, 12428]], [[31630, 8488], [31785, 8333], [31682, 8436], [31220, 8898], [30604, 9514], [30005, 10113], [29370, 10748], [28771, 11347], [28160, 11958], [27581, 12537]], [[33229, 6889], [33288, 6830], [32806, 7312], [31976, 8142], [31120, 8998], [30371, 9747], [29643, 10475], [28959, 11159], [28301, 11817], [27703, 12415]], [[33340, 6778], [33377, 6741], [32860, 7258], [32013, 8105], [31153, 8965], [30397, 9721], [29662, 10456], [28969, 11149], [28311, 11807], [27711, 12407]]]
#   whisper   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ──────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base      │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1       │   +27,519   -13,014    +9,117    +3,897   +27,519   0.2704        +11,047          -11,047           0.8601
#   0.2       │   +15,893   -12,508    +8,761    +3,747   +15,893   0.2314        +10,755          -10,755           0.8528
#   0.3       │   +12,758   -11,793    +8,305    +3,488   +12,758   0.2212        +10,164          -10,164           0.8381
#   0.4       │   +10,742   -10,774    +7,651    +3,123   +10,742   0.2154         +9,278           -9,278           0.8160
#   0.5       │    +9,153    -9,754    +7,007    +2,747    +9,153   0.2112         +8,387           -8,387           0.7938
#   0.6       │    +6,823    -8,811    +6,385    +2,426    +6,823   0.2038         +7,560           -7,560           0.7732
#   0.7       │    +4,621    -7,842    +5,701    +2,141    +4,621   0.1965         +6,702           -6,702           0.7518
#   0.8       │    +3,431    -6,971    +5,117    +1,854    +3,431   0.1932         +5,930           -5,930           0.7325
#   0.9       │    +2,638    -6,160    +4,589    +1,571    +2,638   0.1914         +5,200           -5,200           0.7143
#   1.0       │    +2,065    -5,401    +4,080    +1,321    +2,065   0.1903         +4,525           -4,525           0.6975

#   wav2vec2   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base       │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1        │   +27,738   -12,795   +12,224      +571   +27,738   0.2859         +8,498           -8,498           0.7966
#   0.2        │   +16,061   -12,340   +11,766      +574   +16,061   0.2468         +8,689           -8,689           0.8013
#   0.3        │   +12,943   -11,608   +11,055      +553   +12,943   0.2358         +8,552           -8,552           0.7979
#   0.4        │   +10,944   -10,572   +10,076      +496   +10,944   0.2287         +8,032           -8,032           0.7849
#   0.5        │    +9,385    -9,522    +9,098      +424    +9,385   0.2233         +7,368           -7,368           0.7684
#   0.6        │    +7,038    -8,596    +8,231      +365    +7,038   0.2147         +6,743           -6,743           0.7528
#   0.7        │    +4,790    -7,673    +7,358      +315    +4,790   0.2062         +6,092           -6,092           0.7366
#   0.8        │    +3,577    -6,825    +6,554      +271    +3,577   0.2016         +5,461           -5,461           0.7208
#   0.9        │    +2,754    -6,044    +5,824      +220    +2,754   0.1986         +4,825           -4,825           0.7050
#   1.0        │    +2,163    -5,303    +5,131      +172    +2,163   0.1965         +4,232           -4,232           0.6902

#   libriSpeech LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +27,745   -12,788   +11,766    +1,022   +27,745   0.2839         +8,172           -8,172           0.7884
#   0.2              │   +16,060   -12,341   +11,317    +1,024   +16,060   0.2447         +8,327           -8,327           0.7923
#   0.3              │   +12,942   -11,609   +10,625      +984   +12,942   0.2337         +8,224           -8,224           0.7897
#   0.4              │   +10,944   -10,572    +9,693      +879   +10,944   0.2269         +7,762           -7,762           0.7782
#   0.5              │    +9,380    -9,527    +8,782      +745    +9,380   0.2217         +7,146           -7,146           0.7628
#   0.6              │    +7,036    -8,598    +7,962      +636    +7,036   0.2133         +6,547           -6,547           0.7479
#   0.7              │    +4,789    -7,674    +7,126      +548    +4,789   0.2050         +5,912           -5,912           0.7321
#   0.8              │    +3,575    -6,827    +6,355      +472    +3,575   0.2006         +5,313           -5,313           0.7172
#   0.9              │    +2,754    -6,044    +5,652      +392    +2,754   0.1978         +4,702           -4,702           0.7019
#   1.0              │    +2,162    -5,304    +5,005      +299    +2,162   0.1958         +4,123           -4,123           0.6875

#   Switchboard LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +27,713   -12,820   +11,549    +1,271   +27,713   0.2827         +9,771           -9,771           0.8283
#   0.2              │   +16,034   -12,367   +11,131    +1,236   +16,034   0.2436         +9,830           -9,830           0.8298
#   0.3              │   +12,918   -11,633   +10,514    +1,119   +12,918   0.2330         +9,348           -9,348           0.8177
#   0.4              │   +10,932   -10,584    +9,619      +965   +10,932   0.2265         +8,518           -8,518           0.7970
#   0.5              │    +9,376    -9,531    +8,690      +841    +9,376   0.2212         +7,662           -7,662           0.7757
#   0.6              │    +7,036    -8,598    +7,826      +772    +7,036   0.2127         +6,913           -6,913           0.7570
#   0.7              │    +4,788    -7,675    +6,987      +688    +4,788   0.2044         +6,185           -6,185           0.7389
#   0.8              │    +3,576    -6,826    +6,229      +597    +3,576   0.2000         +5,501           -5,501           0.7218
#   0.9              │    +2,751    -6,047    +5,538      +509    +2,751   0.1972         +4,843           -4,843           0.7054
#   1.0              │    +2,158    -5,308    +4,888      +420    +2,158   0.1952         +4,245           -4,245           0.6905

#   SB-hesitation LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base               │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1                │   +27,709   -12,824   +11,474    +1,350   +27,709   0.2823         +9,882           -9,882           0.8310
#   0.2                │   +16,028   -12,373   +11,067    +1,306   +16,028   0.2433         +9,919           -9,919           0.8320
#   0.3                │   +12,915   -11,636   +10,442    +1,194   +12,915   0.2326         +9,402           -9,402           0.8191
#   0.4                │   +10,930   -10,586    +9,552    +1,034   +10,930   0.2261         +8,555           -8,555           0.7980
#   0.5                │    +9,370    -9,537    +8,629      +908    +9,370   0.2209         +7,695           -7,695           0.7765
#   0.6                │    +7,029    -8,605    +7,773      +832    +7,029   0.2124         +6,939           -6,939           0.7577
#   0.7                │    +4,783    -7,680    +6,946      +734    +4,783   0.2041         +6,204           -6,204           0.7394
#   0.8                │    +3,571    -6,831    +6,193      +638    +3,571   0.1998         +5,511           -5,511           0.7221
#   0.9                │    +2,749    -6,049    +5,501      +548    +2,749   0.1970         +4,853           -4,853           0.7057
#   1.0                │    +2,156    -5,310    +4,854      +456    +2,156   0.1950         +4,253           -4,253           0.6907

# 0.7
#   whisper       │   empty      new   not new          wav2vec2      │   empty     new   not new          libriSpeech LM   │    empty     new   not new          Switchboard LM   │   empty     new   not new          SB-hesitation LM   │   empty      new   not new
#   ──────────────┼───────────────────────────          ──────────────┼──────────────────────────          ─────────────────┼───────────────────────────          ─────────────────┼──────────────────────────          ───────────────────┼───────────────────────────
#   empty         │       0   18,775    10,783          empty         │       0   3,597     9,244          empty            │        0   3,196     9,286          empty            │       0   8,569     9,820          empty              │       0    9,033     9,847
#   transcribed   │     835    4,131   163,291          transcribed   │     866   1,802   165,589          transcribed      │      847   1,817   165,593          transcribed      │     909   2,703   164,645          transcribed        │     909    2,755   164,593
#   not trans.    │   7,434   10,664     2,782          not trans.    │   9,821   9,036     2,023          not trans.       │   10,241   8,662     1,977          not trans.       │   8,532   9,957     2,391          not trans.         │   8,407   10,057     2,416

# wer_data_base = [8599, 20880, 7807, 160450]
# disf_data_base = [23458, 16660]
# wer_data = [[[29701, 8261, 16630, 164246], [20773, 8705, 16321, 164111], [18132, 9392, 15883, 163862], [16481, 10418, 15218, 163501], [15248, 11440, 14570, 163127], [13645, 12347, 13980, 162810], [11938, 13291, 13314, 162532], [10985, 14147, 12744, 162246], [10391, 14939, 12232, 161966], [9970, 15678, 11737, 161722]], [[29877, 8437, 19682, 161018], [20898, 8830, 19286, 161021], [18270, 9530, 18606, 161001], [16626, 10563, 17629, 160945], [15415, 11607, 16657, 160873], [13808, 12510, 15814, 160813], [12060, 13413, 14960, 160764], [11087, 14249, 14169, 160719], [10474, 15022, 13444, 160671], [10039, 15747, 12767, 160623]], [[29883, 8443, 19228, 161466], [20897, 8829, 18840, 161468], [18269, 9529, 18179, 161429], [16626, 10563, 17248, 161326], [15410, 11602, 16343, 161192], [13807, 12509, 15546, 161082], [12059, 13412, 14731, 160994], [11085, 14247, 13974, 160916], [10474, 15022, 13276, 160839], [10038, 15746, 12645, 160746]], [[29859, 8419, 19014, 161704], [20873, 8805, 18665, 161667], [18246, 9506, 18080, 161551], [16614, 10551, 17185, 161401], [15404, 11596, 16264, 161277], [13805, 12507, 15423, 161207], [12058, 13411, 14601, 161125], [11084, 14246, 13858, 161033], [10470, 15018, 13170, 160949], [10033, 15741, 12536, 160860]], [[29853, 8413, 18939, 161785], [20865, 8797, 18600, 161740], [18241, 9501, 18008, 161628], [16610, 10547, 17119, 161471], [15397, 11589, 16203, 161345], [13798, 12500, 15369, 161268], [12053, 13406, 14559, 161172], [11079, 14241, 13821, 161075], [10468, 15016, 13132, 160989], [10031, 15739, 12501, 160897]]]
# disf_data = [[[34283, 5835], [34024, 6094], [33453, 6665], [32558, 7560], [31660, 8458], [30850, 9268], [30009, 10109], [29249, 10869], [28533, 11585], [27875, 12243]], [[31965, 8153], [32127, 7991], [31992, 8126], [31463, 8655], [30790, 9328], [30152, 9966], [29502, 10616], [28874, 11244], [28234, 11884], [27644, 12474]], [[31635, 8483], [31770, 8348], [31668, 8450], [31198, 8920], [30574, 9544], [29965, 10153], [29333, 10785], [28737, 11381], [28120, 11998], [27545, 12573]], [[33150, 6968], [33197, 6921], [32730, 7388], [31895, 8223], [31036, 9082], [30290, 9828], [29572, 10546], [28893, 11225], [28238, 11880], [27645, 12473]], [[33261, 6857], [33291, 6827], [32790, 7328], [31938, 8180], [31072, 9046], [30319, 9799], [29593, 10525], [28906, 11212], [28251, 11867], [27656, 12462]]]
#   whisper   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ──────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base      │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1       │   +21,102   -12,619    +8,823    +3,796   +21,102   0.2495        +10,825          -10,825           0.8546
#   0.2       │   +12,174   -12,175    +8,514    +3,661   +12,174   0.2182        +10,566          -10,566           0.8481
#   0.3       │    +9,533   -11,488    +8,076    +3,412    +9,533   0.2094         +9,995           -9,995           0.8339
#   0.4       │    +7,882   -10,462    +7,411    +3,051    +7,882   0.2048         +9,100           -9,100           0.8116
#   0.5       │    +6,649    -9,440    +6,763    +2,677    +6,649   0.2019         +8,202           -8,202           0.7892
#   0.6       │    +5,046    -8,533    +6,173    +2,360    +5,046   0.1971         +7,392           -7,392           0.7690
#   0.7       │    +3,339    -7,589    +5,507    +2,082    +3,339   0.1917         +6,551           -6,551           0.7480
#   0.8       │    +2,386    -6,733    +4,937    +1,796    +2,386   0.1893         +5,791           -5,791           0.7291
#   0.9       │    +1,792    -5,941    +4,425    +1,516    +1,792   0.1883         +5,075           -5,075           0.7112
#   1.0       │    +1,371    -5,202    +3,930    +1,272    +1,371   0.1878         +4,417           -4,417           0.6948

#   wav2vec2   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base       │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1        │   +21,278   -12,443   +11,875      +568   +21,278   0.2648         +8,507           -8,507           0.7968
#   0.2        │   +12,299   -12,050   +11,479      +571   +12,299   0.2334         +8,669           -8,669           0.8008
#   0.3        │    +9,671   -11,350   +10,799      +551    +9,671   0.2237         +8,534           -8,534           0.7974
#   0.4        │    +8,027   -10,317    +9,822      +495    +8,027   0.2178         +8,005           -8,005           0.7843
#   0.5        │    +6,816    -9,273    +8,850      +423    +6,816   0.2135         +7,332           -7,332           0.7675
#   0.6        │    +5,209    -8,370    +8,007      +363    +5,209   0.2076         +6,694           -6,694           0.7516
#   0.7        │    +3,461    -7,467    +7,153      +314    +3,461   0.2010         +6,044           -6,044           0.7354
#   0.8        │    +2,488    -6,631    +6,362      +269    +2,488   0.1973         +5,416           -5,416           0.7197
#   0.9        │    +1,875    -5,858    +5,637      +221    +1,875   0.1951         +4,776           -4,776           0.7038
#   1.0        │    +1,440    -5,133    +4,960      +173    +1,440   0.1936         +4,186           -4,186           0.6891

#   libriSpeech LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +21,284   -12,437   +11,421    +1,016   +21,284   0.2628         +8,177           -8,177           0.7885
#   0.2              │   +12,298   -12,051   +11,033    +1,018   +12,298   0.2312         +8,312           -8,312           0.7919
#   0.3              │    +9,670   -11,351   +10,372      +979    +9,670   0.2217         +8,210           -8,210           0.7894
#   0.4              │    +8,027   -10,317    +9,441      +876    +8,027   0.2160         +7,740           -7,740           0.7777
#   0.5              │    +6,811    -9,278    +8,536      +742    +6,811   0.2120         +7,116           -7,116           0.7621
#   0.6              │    +5,208    -8,371    +7,739      +632    +5,208   0.2063         +6,507           -6,507           0.7469
#   0.7              │    +3,460    -7,468    +6,924      +544    +3,460   0.1998         +5,875           -5,875           0.7312
#   0.8              │    +2,486    -6,633    +6,167      +466    +2,486   0.1963         +5,279           -5,279           0.7163
#   0.9              │    +1,875    -5,858    +5,469      +389    +1,875   0.1942         +4,662           -4,662           0.7009
#   1.0              │    +1,439    -5,134    +4,838      +296    +1,439   0.1929         +4,087           -4,087           0.6866

#   Switchboard LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +21,260   -12,461   +11,207    +1,254   +21,260   0.2616         +9,692           -9,692           0.8263
#   0.2              │   +12,274   -12,075   +10,858    +1,217   +12,274   0.2302         +9,739           -9,739           0.8275
#   0.3              │    +9,647   -11,374   +10,273    +1,101    +9,647   0.2210         +9,272           -9,272           0.8158
#   0.4              │    +8,015   -10,329    +9,378      +951    +8,015   0.2156         +8,437           -8,437           0.7950
#   0.5              │    +6,805    -9,284    +8,457      +827    +6,805   0.2115         +7,578           -7,578           0.7736
#   0.6              │    +5,206    -8,373    +7,616      +757    +5,206   0.2056         +6,832           -6,832           0.7550
#   0.7              │    +3,459    -7,469    +6,794      +675    +3,459   0.1992         +6,114           -6,114           0.7371
#   0.8              │    +2,485    -6,634    +6,051      +583    +2,485   0.1957         +5,435           -5,435           0.7202
#   0.9              │    +1,871    -5,862    +5,363      +499    +1,871   0.1937         +4,780           -4,780           0.7039
#   1.0              │    +1,434    -5,139    +4,729      +410    +1,434   0.1923         +4,187           -4,187           0.6891

#   SB-hesitation LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base               │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1                │   +21,254   -12,467   +11,132    +1,335   +21,254   0.2612         +9,803           -9,803           0.8291
#   0.2                │   +12,266   -12,083   +10,793    +1,290   +12,266   0.2298         +9,833           -9,833           0.8298
#   0.3                │    +9,642   -11,379   +10,201    +1,178    +9,642   0.2206         +9,332           -9,332           0.8173
#   0.4                │    +8,011   -10,333    +9,312    +1,021    +8,011   0.2152         +8,480           -8,480           0.7961
#   0.5                │    +6,798    -9,291    +8,396      +895    +6,798   0.2112         +7,614           -7,614           0.7745
#   0.6                │    +5,199    -8,380    +7,562      +818    +5,199   0.2053         +6,861           -6,861           0.7557
#   0.7                │    +3,454    -7,474    +6,752      +722    +3,454   0.1989         +6,135           -6,135           0.7376
#   0.8                │    +2,480    -6,639    +6,014      +625    +2,480   0.1955         +5,448           -5,448           0.7205
#   0.9                │    +1,869    -5,864    +5,325      +539    +1,869   0.1935         +4,793           -4,793           0.7042
#   1.0                │    +1,432    -5,141    +4,694      +447    +1,432   0.1922         +4,198           -4,198           0.6894


# 0.9
#   whisper       │   empty      new   not new          wav2vec2      │    empty     new   not new          libriSpeech LM   │    empty     new   not new          Switchboard LM   │   empty     new   not new          SB-hesitation LM   │   empty     new   not new
#   ──────────────┼───────────────────────────          ──────────────┼───────────────────────────          ─────────────────┼───────────────────────────          ─────────────────┼──────────────────────────          ───────────────────┼──────────────────────────
#   empty         │       0   11,749    10,158          empty         │        0   2,608     9,133          empty            │        0   2,195     9,139          empty            │       0   5,801     9,559          empty              │       0   6,130     9,578
#   transcribed   │     884    3,257   164,116          transcribed   │      874   1,646   165,737          transcribed      │      848   1,615   165,794          transcribed      │     912   2,372   164,973          transcribed        │     912   2,415   164,930
#   not trans.    │   8,259   10,039     2,582          not trans.    │   10,269   8,625     1,986          not trans.       │   10,681   8,276     1,923          not trans.       │   9,116   9,440     2,324          not trans.         │   9,006   9,526     2,348

# wer_data_base = [8599, 20880, 7807, 160450]
# disf_data_base = [23458, 16660]
# wer_data = [[[22000, 9139, 15962, 164036], [16184, 9468, 15755, 163914], [14195, 10129, 15322, 163686], [13025, 11139, 14670, 163328], [12237, 12149, 14026, 162962], [11421, 13006, 13473, 162658], [10438, 13888, 12866, 162383], [9843, 14710, 12322, 162105], [9506, 15467, 11838, 161832], [9279, 16168, 11372, 161597]], [[22106, 9245, 18886, 161006], [16257, 9541, 18589, 161007], [14262, 10196, 17950, 160991], [13087, 11201, 16998, 160938], [12303, 12215, 16054, 160868], [11486, 13071, 15261, 160805], [10481, 13931, 14454, 160752], [9879, 14746, 13684, 160707], [9532, 15493, 12987, 160657], [9303, 16192, 12336, 160609]], [[22108, 9247, 18462, 161428], [16256, 9540, 18167, 161430], [14261, 10195, 17547, 161395], [13085, 11199, 16643, 161295], [12299, 12211, 15761, 161165], [11486, 13071, 15013, 161053], [10482, 13932, 14242, 160963], [9879, 14746, 13504, 160887], [9534, 15495, 12832, 160810], [9303, 16192, 12226, 160719]], [[22082, 9221, 18293, 161623], [16227, 9511, 18036, 161590], [14236, 10170, 17479, 161488], [13073, 11187, 16603, 161347], [12293, 12205, 15705, 161227], [11484, 13069, 14910, 161158], [10480, 13930, 14133, 161074], [9876, 14743, 13412, 160982], [9528, 15489, 12749, 160899], [9296, 16185, 12140, 160812]], [[22076, 9215, 18223, 161699], [16221, 9505, 17969, 161663], [14232, 10166, 17410, 161561], [13070, 11184, 16541, 161412], [12287, 12199, 15646, 161292], [11478, 13063, 14860, 161214], [10476, 13926, 14095, 161116], [9872, 14739, 13379, 161019], [9527, 15488, 12715, 160934], [9295, 16184, 12109, 160844]]]
# disf_data = [[[33733, 6385], [33531, 6587], [32977, 7141], [32095, 8023], [31194, 8924], [30424, 9694], [29628, 10490], [28891, 11227], [28205, 11913], [27581, 12537]], [[31833, 8285], [31952, 8166], [31790, 8328], [31256, 8862], [30580, 9538], [29940, 10178], [29287, 10831], [28664, 11454], [28030, 12088], [27453, 12665]], [[31497, 8621], [31598, 8520], [31478, 8640], [31008, 9110], [30381, 9737], [29771, 10347], [29142, 10976], [28547, 11571], [27935, 12183], [27373, 12745]], [[32893, 7225], [32909, 7209], [32458, 7660], [31639, 8479], [30784, 9334], [30053, 10065], [29339, 10779], [28669, 11449], [28022, 12096], [27442, 12676]], [[32998, 7120], [32997, 7121], [32516, 7602], [31679, 8439], [30818, 9300], [30081, 10037], [29360, 10758], [28682, 11436], [28035, 12083], [27453, 12665]]]
#   whisper   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ──────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base      │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1       │   +13,401   -11,741    +8,155    +3,586   +13,401   0.2231        +10,275          -10,275           0.8408
#   0.2       │    +7,585   -11,412    +7,948    +3,464    +7,585   0.2017        +10,073          -10,073           0.8358
#   0.3       │    +5,596   -10,751    +7,515    +3,236    +5,596   0.1950         +9,519           -9,519           0.8220
#   0.4       │    +4,426    -9,741    +6,863    +2,878    +4,426   0.1921         +8,637           -8,637           0.8000
#   0.5       │    +3,638    -8,731    +6,219    +2,512    +3,638   0.1907         +7,736           -7,736           0.7776
#   0.6       │    +2,822    -7,874    +5,666    +2,208    +2,822   0.1890         +6,966           -6,966           0.7584
#   0.7       │    +1,839    -6,992    +5,059    +1,933    +1,839   0.1864         +6,170           -6,170           0.7385
#   0.8       │    +1,244    -6,170    +4,515    +1,655    +1,244   0.1853         +5,433           -5,433           0.7202
#   0.9       │      +907    -5,413    +4,031    +1,382      +907   0.1853         +4,747           -4,747           0.7031
#   1.0       │      +680    -4,712    +3,565    +1,147      +680   0.1856         +4,123           -4,123           0.6875

#   wav2vec2   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base       │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1        │   +13,507   -11,635   +11,079      +556   +13,507   0.2378         +8,375           -8,375           0.7935
#   0.2        │    +7,658   -11,339   +10,782      +557    +7,658   0.2161         +8,494           -8,494           0.7965
#   0.3        │    +5,663   -10,684   +10,143      +541    +5,663   0.2085         +8,332           -8,332           0.7924
#   0.4        │    +4,488    -9,679    +9,191      +488    +4,488   0.2042         +7,798           -7,798           0.7791
#   0.5        │    +3,704    -8,665    +8,247      +418    +3,704   0.2014         +7,122           -7,122           0.7623
#   0.6        │    +2,887    -7,809    +7,454      +355    +2,887   0.1985         +6,482           -6,482           0.7463
#   0.7        │    +1,882    -6,949    +6,647      +302    +1,882   0.1947         +5,829           -5,829           0.7300
#   0.8        │    +1,280    -6,134    +5,877      +257    +1,280   0.1925         +5,206           -5,206           0.7145
#   0.9        │      +933    -5,387    +5,180      +207      +933   0.1913         +4,572           -4,572           0.6987
#   1.0        │      +704    -4,688    +4,529      +159      +704   0.1906         +3,995           -3,995           0.6843

#   libriSpeech LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +13,509   -11,633   +10,655      +978   +13,509   0.2358         +8,039           -8,039           0.7851
#   0.2              │    +7,657   -11,340   +10,360      +980    +7,657   0.2140         +8,140           -8,140           0.7876
#   0.3              │    +5,662   -10,685    +9,740      +945    +5,662   0.2065         +8,020           -8,020           0.7846
#   0.4              │    +4,486    -9,681    +8,836      +845    +4,486   0.2024         +7,550           -7,550           0.7729
#   0.5              │    +3,700    -8,669    +7,954      +715    +3,700   0.1999         +6,923           -6,923           0.7573
#   0.6              │    +2,887    -7,809    +7,206      +603    +2,887   0.1972         +6,313           -6,313           0.7421
#   0.7              │    +1,883    -6,948    +6,435      +513    +1,883   0.1936         +5,684           -5,684           0.7264
#   0.8              │    +1,280    -6,134    +5,697      +437    +1,280   0.1916         +5,089           -5,089           0.7116
#   0.9              │      +935    -5,385    +5,025      +360      +935   0.1906         +4,477           -4,477           0.6963
#   1.0              │      +704    -4,688    +4,419      +269      +704   0.1901         +3,915           -3,915           0.6823

#   Switchboard LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ─────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base             │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1              │   +13,483   -11,659   +10,486    +1,173   +13,483   0.2348         +9,435           -9,435           0.8199
#   0.2              │    +7,628   -11,369   +10,229    +1,140    +7,628   0.2132         +9,451           -9,451           0.8203
#   0.3              │    +5,637   -10,710    +9,672    +1,038    +5,637   0.2060         +9,000           -9,000           0.8091
#   0.4              │    +4,474    -9,693    +8,796      +897    +4,474   0.2021         +8,181           -8,181           0.7886
#   0.5              │    +3,694    -8,675    +7,898      +777    +3,694   0.1996         +7,326           -7,326           0.7673
#   0.6              │    +2,885    -7,811    +7,103      +708    +2,885   0.1967         +6,595           -6,595           0.7491
#   0.7              │    +1,881    -6,950    +6,326      +624    +1,881   0.1931         +5,881           -5,881           0.7313
#   0.8              │    +1,277    -6,137    +5,605      +532    +1,277   0.1911         +5,211           -5,211           0.7146
#   0.9              │      +929    -5,391    +4,942      +449      +929   0.1901         +4,564           -4,564           0.6985
#   1.0              │      +697    -4,695    +4,333      +362      +697   0.1896         +3,984           -3,984           0.6840

#   SB-hesitation LM   │    insert    delete   replace   nothing       all      WER   disf. trans.   disf. untrans.   disf. trans. %
#   ───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   base               │     8,599    20,880     7,807   160,450   197,736   0.1886         23,458           16,660           0.5847
#   0.1                │   +13,477   -11,665   +10,416    +1,249   +13,477   0.2344         +9,540           -9,540           0.8225
#   0.2                │    +7,622   -11,375   +10,162    +1,213    +7,622   0.2128         +9,539           -9,539           0.8225
#   0.3                │    +5,633   -10,714    +9,603    +1,111    +5,633   0.2056         +9,058           -9,058           0.8105
#   0.4                │    +4,471    -9,696    +8,734      +962    +4,471   0.2017         +8,221           -8,221           0.7896
#   0.5                │    +3,688    -8,681    +7,839      +842    +3,688   0.1992         +7,360           -7,360           0.7682
#   0.6                │    +2,879    -7,817    +7,053      +764    +2,879   0.1964         +6,623           -6,623           0.7498
#   0.7                │    +1,877    -6,954    +6,288      +666    +1,877   0.1929         +5,902           -5,902           0.7318
#   0.8                │    +1,273    -6,141    +5,572      +569    +1,273   0.1909         +5,224           -5,224           0.7149
#   0.9                │      +928    -5,392    +4,908      +484      +928   0.1899         +4,577           -4,577           0.6988
#   1.0                │      +696    -4,696    +4,302      +394      +696   0.1894         +3,995           -3,995           0.6843